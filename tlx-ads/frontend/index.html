<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>TLXAUTO</title>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Fraunces:opsz,wght@9..144,600;700&display=swap");

      :root {
        --bg: #F6F2EA;
        --bg2: #F2ECE2;
        --panel: #FFFFFF;
        --panel2: #F8F4EE;
        --border: #E7DDCF;
        --border2: #CDBDA7;
        --text: #1E1C1A;
        --muted: #6C5F52;
        --primary: #0E7C7B;
        --primary2: #0A5757;
        --accent: #C4622D;
        --accent2: #9C4C24;
        --danger: #C0362C;
        --ok: #1B8D5A;
        --shadow: 0 12px 24px rgba(76, 63, 52, 0.18);
        --radius: 18px;
      }

      * { box-sizing: border-box; }

      body {
        font-family: "Space Grotesk", "IBM Plex Sans", "Noto Sans", sans-serif;
        max-width: 1120px;
        margin: 24px auto 48px;
        padding: 0 18px;
        background:
          radial-gradient(600px 400px at 12% -8%, rgba(14, 124, 123, 0.20), transparent 58%),
          radial-gradient(420px 260px at 88% 8%, rgba(196, 98, 45, 0.16), transparent 60%),
          linear-gradient(180deg, var(--bg), var(--bg2));
        color: var(--text);
      }

      a { color: var(--primary); text-decoration: none; }
      a:hover { color: #135C5C; text-decoration: underline; }

      .row { display: flex; gap: 12px; flex-wrap: wrap; }

      input, textarea, select, button {
        padding: 12px 12px;
        font-size: 14px;
        border-radius: 12px;
      }

      input, textarea, select {
        width: 100%;
        background: rgba(255, 255, 255, 0.72);
        color: var(--text);
        border: 1px solid var(--border);
        outline: none;
        transition: border-color 120ms ease, box-shadow 120ms ease, background 120ms ease;
      }

      input::placeholder, textarea::placeholder { color: rgba(108, 95, 82, 0.65); }

      input:focus, textarea:focus, select:focus {
        border-color: rgba(14, 124, 123, 0.75);
        box-shadow: 0 0 0 4px rgba(14, 124, 123, 0.18);
        background: rgba(255, 255, 255, 0.92);
      }

      textarea { min-height: 120px; }

      button {
        cursor: pointer;
        border: 1px solid rgba(30, 28, 26, 0.12);
        background: rgba(255, 255, 255, 0.92);
        color: var(--text);
        transition: transform 80ms ease, background 120ms ease, border-color 120ms ease, box-shadow 120ms ease;
      }
      button:hover { background: rgba(255, 255, 255, 1); border-color: rgba(14, 124, 123, 0.45); }
      button:active { transform: translateY(1px); }
      button:focus { outline: none; box-shadow: 0 0 0 4px rgba(14, 124, 123, 0.16); }

      /* CTA (Azul Tech) */
      #btnLogin, #btnRegister, #btnCreateAd, #btnRefresh, #btnAcceptInvite, #btnRequestReset, #btnConfirmReset {
        background: linear-gradient(180deg, rgba(14, 124, 123, 0.95), rgba(10, 87, 87, 0.95));
        border-color: rgba(14, 124, 123, 0.45);
        color: #fff;
        box-shadow: 0 8px 20px rgba(14, 124, 123, 0.18);
      }
      #btnLogin:hover, #btnRegister:hover, #btnCreateAd:hover, #btnRefresh:hover, #btnAcceptInvite:hover, #btnRequestReset:hover, #btnConfirmReset:hover {
        box-shadow: 0 10px 26px rgba(14, 124, 123, 0.26);
      }

      .card {
        border: 1px solid rgba(231, 221, 207, 0.9);
        background: linear-gradient(180deg, rgba(255, 255, 255, 0.97), rgba(248, 244, 238, 0.98));
        border-radius: var(--radius);
        padding: 16px;
        margin: 12px 0;
        box-shadow: var(--shadow);
      }

      .muted { color: var(--muted); }

      .topbar {
        display:flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 14px;
        padding: 14px 16px;
        border-radius: var(--radius);
        border: 1px solid rgba(231, 221, 207, 0.9);
        background: rgba(255, 255, 255, 0.82);
        backdrop-filter: blur(8px);
      }
      .brandTitle {
        font-family: "Fraunces", "Georgia", serif;
        font-weight: 700;
        letter-spacing: 0.2px;
        margin: 0;
      }

      nav.card {
        display:flex;
        gap: 12px;
        align-items: center;
        flex-wrap: wrap;
      }
      nav.card a {
        display:inline-flex;
        align-items:center;
        gap: 8px;
        padding: 10px 14px;
        border-radius: 999px;
        border: 1px solid rgba(231, 221, 207, 0.9);
        background: rgba(255, 255, 255, 0.7);
        color: var(--text);
      }
      nav.card a[aria-current="page"] {
        background: rgba(14, 124, 123, 0.12);
        border-color: rgba(14, 124, 123, 0.45);
        color: var(--primary2);
      }
      nav.card a:hover {
        text-decoration: none;
        border-color: rgba(14, 124, 123, 0.35);
        box-shadow: 0 0 0 4px rgba(14, 124, 123, 0.14);
      }

      .hidden { display: none; }
      .grid2 { display:grid; grid-template-columns: 1fr 1fr; gap: 12px; }
      @media (max-width: 700px) { .grid2 { grid-template-columns: 1fr; } }

      /* Alerts */
      .danger { color: var(--danger); }
      .ok { color: var(--ok); }
      .card.danger {
        border-color: rgba(192, 54, 44, 0.30);
        background: linear-gradient(180deg, rgba(192, 54, 44, 0.10), rgba(255, 255, 255, 0.96));
      }
      .card.ok {
        border-color: rgba(27, 141, 90, 0.25);
        background: linear-gradient(180deg, rgba(27, 141, 90, 0.10), rgba(255, 255, 255, 0.96));
      }

      /* Pills (neutro + destaque premium opcional) */
      .pill {
        display:inline-block;
        padding: 4px 10px;
        border-radius: 999px;
        border: 1px solid rgba(231, 221, 207, 0.9);
        font-size: 12px;
        color: rgba(30, 28, 26, 0.85);
        background: rgba(255, 255, 255, 0.7);
      }
      .pill.premium {
        border-color: rgba(196, 98, 45, 0.45);
        color: rgba(156, 76, 36, 0.98);
        background: rgba(196, 98, 45, 0.12);
      }

      /* KPIs (dourado só onde importa) */
      .kpiGrid {
        display: grid;
        grid-template-columns: repeat(3, minmax(0, 1fr));
        gap: 12px;
      }
      @media (max-width: 800px) {
        .kpiGrid { grid-template-columns: 1fr; }
      }
      .kpi {
        border: 1px solid rgba(231, 221, 207, 0.9);
        border-radius: 14px;
        padding: 12px;
        background: rgba(255, 255, 255, 0.8);
      }
      .kpiValue {
        margin-top: 6px;
        font-size: 22px;
        font-weight: 700;
        letter-spacing: 0.2px;
      }
      .kpi.premium {
        border-color: rgba(196, 98, 45, 0.25);
        background: linear-gradient(180deg, rgba(196, 98, 45, 0.10), rgba(255, 255, 255, 0.9));
      }
      .kpi.premium .kpiValue {
        color: rgba(156, 76, 36, 0.98);
        text-shadow: 0 10px 26px rgba(156, 76, 36, 0.10);
      }
      .kpi.danger {
        border-color: rgba(192, 54, 44, 0.45);
        background: linear-gradient(180deg, rgba(192, 54, 44, 0.12), rgba(255, 255, 255, 0.9));
      }
      .kpi.danger .kpiValue {
        color: rgba(112, 28, 24, 0.98);
        text-shadow: 0 10px 26px rgba(192, 54, 44, 0.10);
      }

      /* Anúncios (layout mais enterprise) */
      .adHeader {
        display:flex;
        justify-content: space-between;
        align-items: flex-start;
        gap: 12px;
        flex-wrap: wrap;
      }
      .adTitle {
        font-size: 16px;
        font-weight: 750;
        letter-spacing: 0.2px;
      }
      .adPills { display:flex; gap: 8px; flex-wrap: wrap; align-items:center; }
      .adBody { margin-top: 10px; white-space: pre-wrap; line-height: 1.45; color: rgba(30, 28, 26, 0.92); }
      .adMeta { margin-top: 10px; display:flex; flex-wrap: wrap; gap: 10px; }
      .adActions {
        min-width: 230px;
        display:flex;
        flex-direction: column;
        gap: 10px;
      }
      @media (max-width: 700px) {
        .adActions { min-width: 100%; }
      }
      .btn {
        width: 100%;
        text-align: left;
        border-radius: 12px;
      }
      .btn-secondary {
        background: rgba(255, 255, 255, 0.85);
        border-color: rgba(231, 221, 207, 0.9);
      }
      .btn-secondary:hover {
        border-color: rgba(14, 124, 123, 0.22);
        box-shadow: 0 0 0 4px rgba(14, 124, 123, 0.12);
      }
      .btn-danger {
        background: rgba(192, 54, 44, 0.12);
        border-color: rgba(192, 54, 44, 0.32);
        color: rgba(112, 28, 24, 0.98);
      }
      .btn-danger:hover {
        border-color: rgba(192, 54, 44, 0.45);
        box-shadow: 0 0 0 4px rgba(192, 54, 44, 0.14);
      }
      code {
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
        color: rgba(30, 28, 26, 0.92);
        background: rgba(255, 255, 255, 0.72);
        padding: 2px 6px;
        border-radius: 8px;
        border: 1px solid rgba(231, 221, 207, 0.9);
      }

      /* Planos */
      .planHero {
        display:flex;
        align-items:flex-start;
        justify-content:space-between;
        gap: 12px;
        flex-wrap: wrap;
      }
      .planHero h3 { margin: 0; }

      .planGrid {
        display: grid;
        grid-template-columns: repeat(4, minmax(0, 1fr));
        gap: 12px;
        margin-top: 12px;
      }
      @media (max-width: 980px) { .planGrid { grid-template-columns: repeat(2, minmax(0, 1fr)); } }
      @media (max-width: 640px) { .planGrid { grid-template-columns: 1fr; } }

      .planCard {
        border-radius: var(--radius);
        border: 1px solid rgba(231, 221, 207, 0.9);
        background: rgba(255, 255, 255, 0.86);
        padding: 14px;
        box-shadow: var(--shadow);
        display:flex;
        flex-direction: column;
        min-height: 320px;
      }
      .planCard.recommended {
        border-color: rgba(196, 98, 45, 0.35);
        box-shadow: 0 12px 28px rgba(196, 98, 45, 0.10), var(--shadow);
      }
      .planTop {
        display:flex;
        justify-content:space-between;
        gap: 10px;
        align-items:flex-start;
      }
      .planName {
        font-weight: 800;
        font-size: 16px;
        letter-spacing: 0.2px;
      }
      .planPrice {
        margin-top: 8px;
        font-size: 20px;
        font-weight: 900;
      }
      .planSub {
        margin-top: 4px;
        color: rgba(108, 95, 82, 0.80);
        font-size: 12px;
      }
      .planFeatures {
        margin-top: 12px;
        display:flex;
        flex-direction: column;
        gap: 8px;
        flex: 1 1 auto;
      }
      .planFeatures li {
        list-style: none;
        padding-left: 0;
        color: rgba(30, 28, 26, 0.9);
        line-height: 1.35;
      }
      .planFeatures li .muted { color: rgba(108, 95, 82, 0.75); }

      .planCtaRow { margin-top: 12px; }
      .planCtaRow button { width: 100%; }

      .planHint {
        margin-top: 10px;
        font-size: 12px;
        color: rgba(108, 95, 82, 0.75);
      }

      .planCurrent {
        margin-top: 12px;
        border-radius: 14px;
        border: 1px solid rgba(14, 124, 123, 0.25);
        background: rgba(14, 124, 123, 0.08);
        padding: 12px;
      }

      .filtersRow {
        display: grid;
        grid-template-columns: 2fr 1fr 1fr auto;
        gap: 12px;
        align-items: end;
      }
      @media (max-width: 900px) {
        .filtersRow { grid-template-columns: 1fr 1fr; }
      }
      @media (max-width: 640px) {
        .filtersRow { grid-template-columns: 1fr; }
      }

      .statusRow {
        display:flex;
        justify-content: space-between;
        align-items: center;
        gap: 12px;
        flex-wrap: wrap;
      }
      .statusSummary {
        display:flex;
        gap: 8px;
        flex-wrap: wrap;
        color: var(--muted);
        font-size: 13px;
      }

      .ghostBtn {
        border-style: dashed;
        background: transparent;
      }

      .metricGrid {
        display: grid;
        grid-template-columns: repeat(4, minmax(0, 1fr));
        gap: 12px;
      }
      @media (max-width: 900px) {
        .metricGrid { grid-template-columns: repeat(2, minmax(0, 1fr)); }
      }
      @media (max-width: 560px) {
        .metricGrid { grid-template-columns: 1fr; }
      }

      .templateGrid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
      }
      @media (max-width: 900px) {
        .templateGrid { grid-template-columns: 1fr; }
      }

      .templateList {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .historyChart {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(24px, 1fr));
        gap: 6px;
        align-items: end;
        height: 140px;
      }
      .historyBar {
        width: 100%;
        border-radius: 8px 8px 4px 4px;
        background: linear-gradient(180deg, rgba(14, 124, 123, 0.85), rgba(10, 87, 87, 0.8));
        box-shadow: 0 6px 18px rgba(14, 124, 123, 0.18);
        position: relative;
        overflow: hidden;
        display: flex;
        align-items: flex-end;
      }
      .historyBar.low {
        background: linear-gradient(180deg, rgba(196, 98, 45, 0.75), rgba(156, 76, 36, 0.75));
      }
      .historyBarInner {
        width: 100%;
        background: linear-gradient(180deg, rgba(196, 98, 45, 0.8), rgba(156, 76, 36, 0.8));
        border-radius: 6px 6px 2px 2px;
      }

      .barTrack {
        width: 100%;
        height: 10px;
        background: rgba(231, 221, 207, 0.8);
        border-radius: 999px;
        overflow: hidden;
      }
      .barFill {
        height: 100%;
        background: linear-gradient(90deg, rgba(14, 124, 123, 0.85), rgba(10, 87, 87, 0.85));
      }
      .historyLabelRow {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(24px, 1fr));
        gap: 6px;
        margin-top: 8px;
        font-size: 10px;
        color: var(--muted);
      }

      .varsForm {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        margin-top: 8px;
      }
      @media (max-width: 900px) {
        .varsForm { grid-template-columns: 1fr; }
      }

      .listGrid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
      }
      @media (max-width: 900px) {
        .listGrid { grid-template-columns: 1fr; }
      }

      .miniTable {
        width: 100%;
        border-collapse: collapse;
        font-size: 13px;
      }
      .miniTable th, .miniTable td {
        padding: 8px 6px;
        border-bottom: 1px solid var(--border);
        text-align: left;
        vertical-align: top;
      }
      .miniTable th {
        color: var(--muted);
        font-weight: 600;
        font-size: 12px;
      }

      .fadeIn {
        animation: fadeInUp 0.6s ease both;
      }
      .stagger > * {
        animation: fadeInUp 0.6s ease both;
      }
      .stagger > *:nth-child(2) { animation-delay: 0.04s; }
      .stagger > *:nth-child(3) { animation-delay: 0.08s; }
      .stagger > *:nth-child(4) { animation-delay: 0.12s; }

      @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(8px); }
        to { opacity: 1; transform: translateY(0); }
      }
    </style>
  </head>
  <body>
    <div class="topbar">
      <div>
        <h2 class="brandTitle">TLXAUTO — Plataforma de Anúncios</h2>
        <div class="muted" style="margin-top:6px;">Operação simples, execução afiada, resultado na veia.</div>
      </div>
      <div>
        <span id="userInfo" class="muted" style="margin-right:10px;"></span>
        <button id="btnLogout" class="hidden">Sair</button>
      </div>
    </div>

    <nav class="card">
      <a href="/" id="navHome">Home</a>
      <a href="/planos" id="navPlans">Planos</a>
      <a href="/accept-invite" id="navAccept">Aceitar Convite</a>
      <a href="/reset-password" id="navReset">Reset de Senha</a>
      <span class="muted" style="float:right;">API: <code id="apiBaseLabel"></code></span>
    </nav>

    <div id="alerts" class="fadeIn" role="status" aria-live="polite"></div>

    <section id="authSection" class="card fadeIn">
      <h3>Login / Cadastro</h3>
      <div class="grid2">
        <div>
          <label>Email</label>
          <input id="email" type="email" placeholder="voce@dominio.com" />
        </div>
        <div>
          <label>Senha</label>
          <input id="password" type="password" placeholder="mínimo 6 caracteres" />
        </div>
      </div>
      <div style="margin-top: 10px;">
        <label>Tenant (slug) — opcional</label>
        <input id="tenantSlug" placeholder="default" />
        <div class="muted" style="margin-top:6px;">Se deixar vazio, usa <code>default</code>. Se informar um slug novo no cadastro, cria um tenant.</div>
      </div>
      <div class="row" style="margin-top: 12px;">
        <button id="btnLogin">Entrar</button>
        <button id="btnRegister">Cadastrar</button>
      </div>
      <p class="muted">Backend padrão: <code>http://localhost:8000</code> (ajuste em <code>app.ts</code>).</p>
    </section>

    <section id="acceptInviteSection" class="card hidden fadeIn">
      <h3>Aceitar Convite</h3>
      <p class="muted">Abra via link do convite: <code>/accept-invite?token=...</code></p>

      <div class="grid2">
        <div>
          <label>Token</label>
          <input id="inviteToken" placeholder="token do convite" />
        </div>
        <div>
          <label>Senha (nova)</label>
          <input id="invitePassword" type="password" placeholder="mínimo 6 caracteres" />
        </div>
      </div>

      <div class="row" style="margin-top: 12px;">
        <button id="btnAcceptInvite">Aceitar convite</button>
      </div>
    </section>

    <section id="resetPasswordSection" class="card hidden fadeIn">
      <h3>Reset de Senha</h3>

      <div class="card">
        <h4>1) Solicitar token</h4>
        <div class="grid2">
          <div>
            <label>Email</label>
            <input id="resetEmail" type="email" placeholder="voce@dominio.com" />
          </div>
          <div>
            <label>&nbsp;</label>
            <button id="btnRequestReset">Enviar token</button>
          </div>
        </div>
        <p class="muted">Se SMTP estiver configurado, chega por email. Em dev, a API pode retornar o token/link.</p>
      </div>

      <div class="card">
        <h4>2) Confirmar reset</h4>
        <p class="muted">Abra via link: <code>/reset-password?token=...</code></p>
        <div class="grid2">
          <div>
            <label>Token</label>
            <input id="resetToken" placeholder="token do reset" />
          </div>
          <div>
            <label>Nova senha</label>
            <input id="resetNewPassword" type="password" placeholder="mínimo 6 caracteres" />
          </div>
        </div>
        <div class="row" style="margin-top: 12px;">
          <button id="btnConfirmReset">Confirmar reset</button>
        </div>
      </div>
    </section>

    <section id="plansSection" class="card hidden fadeIn">
      <div class="planHero">
        <div>
          <h3>Planos — TLXAUTO Ads</h3>
          <div class="muted" style="margin-top:6px;">
            Planos mensais em USD para seus clientes assinarem sem burocracia. Escolha o ideal e evolua quando precisar.
          </div>
        </div>
        <div style="display:flex; gap:8px; flex-wrap:wrap;">
          <span class="pill">Cobranca mensal</span>
          <span class="pill premium">Sem fidelidade</span>
        </div>
      </div>

      <div id="planCurrentBox" class="planCurrent hidden"></div>
      <div class="row" style="margin-top:10px;">
        <button id="btnBillingPortal" class="ghostBtn hidden">Gerenciar assinatura</button>
        <button id="btnCancelPlan" class="ghostBtn hidden">Cancelar assinatura</button>
      </div>
      <div id="plansGrid" class="planGrid"></div>
      <div class="planHint">
        Dica: voce pode começar no Essencial e subir de plano quando bater nos limites.
      </div>
    </section>

    <section id="appSection" class="hidden">
      <div class="card fadeIn" id="kpiSection">
        <div style="display:flex; justify-content:space-between; align-items:flex-start; gap:12px; flex-wrap:wrap;">
          <div>
            <div style="display:flex; align-items:center; gap:10px; flex-wrap:wrap;">
              <h3 style="margin:0;">Resultados</h3>
              <span id="tlxStatus" class="pill premium hidden">TLX Premium</span>
            </div>
            <div class="muted" style="margin-top:6px;">O que gera dinheiro/status fica em destaque. O resto fica clean.</div>
          </div>
          <div class="muted" style="margin-top:6px;">Atualizado: <span id="kpiTs">—</span></div>
        </div>

        <div class="kpiGrid stagger" style="margin-top:12px;">
          <div class="kpi">
            <div class="muted">Cliques</div>
            <div class="kpiValue" id="kpiClicks">—</div>
          </div>
          <div class="kpi premium">
            <div class="muted">Conversões</div>
            <div class="kpiValue" id="kpiConversions">—</div>
          </div>
          <div class="kpi">
            <div class="muted">CTR (proxy)</div>
            <div class="kpiValue" id="kpiCtr">—</div>
          </div>
        </div>
      </div>

      <div class="card fadeIn">
        <div style="display:flex; justify-content:space-between; align-items:center; gap:12px; flex-wrap:wrap;">
          <div>
            <h3 style="margin:0;">Relatorios</h3>
            <div class="muted" style="margin-top:6px;">Funnel simples para acompanhar eficiencia.</div>
          </div>
          <div class="row">
            <button id="btnRefreshReports" class="ghostBtn">Atualizar relatorios</button>
            <select id="reportsDays">
              <option value="7">7 dias</option>
              <option value="14" selected>14 dias</option>
              <option value="30">30 dias</option>
              <option value="90">90 dias</option>
            </select>
            <label class="muted" style="display:flex; align-items:center; gap:6px;">
              <input type="checkbox" id="reportsAutoRefresh" /> Auto
            </label>
          </div>
        </div>
        <div class="metricGrid" style="margin-top:12px;">
          <div class="kpi">
            <div class="muted">Impressões (proxy)</div>
            <div class="kpiValue" id="kpiImpressions">—</div>
          </div>
          <div class="kpi">
            <div class="muted">Taxa de clique</div>
            <div class="kpiValue" id="kpiCtrPct">—</div>
          </div>
          <div class="kpi premium">
            <div class="muted">Taxa de conversão</div>
            <div class="kpiValue" id="kpiCvr">—</div>
          </div>
          <div class="kpi">
            <div class="muted">Conversões por 100 cliques</div>
            <div class="kpiValue" id="kpiConvPerClick">—</div>
          </div>
        </div>
        <div class="card" style="margin-top:12px;">
          <div class="muted" style="margin-bottom:8px;" id="historyTitle">Historico 14 dias (cliques)</div>
          <div id="historyChart" class="historyChart"></div>
          <div id="historyLabels" class="historyLabelRow"></div>
        </div>

        <div class="templateGrid" style="margin-top:12px;">
          <div class="card">
            <div style="font-weight:700;">Por canal</div>
            <table class="miniTable" style="margin-top:8px;">
              <thead>
                <tr>
                  <th>Canal</th>
                  <th>Cliques</th>
                  <th>Conv</th>
                  <th>CTR</th>
                </tr>
              </thead>
              <tbody id="channelsTable"></tbody>
            </table>
            <div class="muted" style="margin-top:8px;">Conversoes por canal</div>
            <div id="channelsChart" class="historyChart"></div>
          </div>
          <div class="card">
            <div style="font-weight:700;">Por campanha</div>
            <table class="miniTable" style="margin-top:8px;">
              <thead>
                <tr>
                  <th>Campanha</th>
                  <th>Total</th>
                  <th>Sent</th>
                  <th>Fail</th>
                </tr>
              </thead>
              <tbody id="campaignsTable"></tbody>
            </table>
            <div class="muted" style="margin-top:8px;">Conversoes por campanha</div>
            <div id="campaignsChart" class="historyChart"></div>
          </div>
        </div>

        <div class="card" style="margin-top:12px;">
          <div style="font-weight:700;">SLA de entregas</div>
          <div class="metricGrid" style="margin-top:10px;">
            <div class="kpi">
              <div class="muted">Total</div>
              <div class="kpiValue" id="slaTotal">—</div>
            </div>
            <div class="kpi premium" id="slaFailCard">
              <div class="muted">Falha (%)</div>
              <div class="kpiValue" id="slaFailRate">—</div>
            </div>
            <div class="kpi">
              <div class="muted">Tentativas médias</div>
              <div class="kpiValue" id="slaAttempts">—</div>
            </div>
            <div class="kpi">
              <div class="muted">Tempo médio (s)</div>
              <div class="kpiValue" id="slaAvgTime">—</div>
            </div>
          </div>
          <div class="muted" id="slaStatus" style="margin-top:8px;"></div>
        </div>
      </div>

      <div class="card fadeIn">
        <h3>Novo Anúncio</h3>
        <div class="grid2">
          <div>
            <label>Título</label>
            <input id="adTitle" placeholder="Título do anúncio" />
          </div>
          <div>
            <label>Canal</label>
            <select id="adChannel">
              <option value="whatsapp">WhatsApp</option>
              <option value="x">X (Twitter)</option>
              <option value="email">Email</option>
            </select>
          </div>
        </div>

        <div class="grid2" style="margin-top: 10px;">
          <div>
            <label>Template (opcional)</label>
            <select id="adTemplate">
              <option value="">Sem template</option>
            </select>
          </div>
          <div>
            <label>Variáveis (JSON)</label>
            <input id="adVariables" placeholder='{"produto":"Plano Pro","desconto":"20%"}' />
          </div>
        </div>
        <div class="grid2" style="margin-top: 10px;">
          <div>
            <label>Campanha (opcional)</label>
            <select id="adCampaignId">
              <option value="">Sem campanha</option>
            </select>
          </div>
          <div>
            <label>&nbsp;</label>
            <div class="muted">Vincule o anuncio para métricas por campanha.</div>
          </div>
        </div>
        <div id="adVariablesForm" class="varsForm"></div>

        <div style="margin-top: 10px;">
          <label>Texto</label>
          <textarea id="adBody" placeholder="Escreva seu anúncio aqui..."></textarea>
        </div>

        <div style="margin-top: 10px;">
          <label>URL (opcional)</label>
          <input id="adUrl" placeholder="https://..." />
        </div>

        <div class="row" style="margin-top: 12px;">
          <button id="btnCreateAd">Criar (Draft)</button>
          <button id="btnRefresh">Atualizar Lista</button>
          <button id="btnPreviewAd" class="ghostBtn">Preview</button>
        </div>

        <div id="adPreview" class="card hidden" style="margin-top:10px;">
          <div class="muted" style="margin-bottom:6px;">Preview</div>
          <div id="adPreviewBody" style="white-space: pre-wrap;"></div>
        </div>
      </div>

      <div class="card fadeIn">
        <div style="display:flex; justify-content:space-between; align-items:center; gap:12px; flex-wrap:wrap;">
          <div>
            <h3 style="margin:0;">Templates</h3>
            <div class="muted" style="margin-top:6px;">Salve padroes e reutilize textos rapidamente.</div>
          </div>
          <button id="btnUseAdAsTemplate" class="ghostBtn">Usar texto do anuncio</button>
        </div>

        <div class="templateGrid" style="margin-top:12px;">
          <div>
            <label>Nome do template</label>
            <input id="tplName" placeholder="Ex: Oferta Semana 01" />
            <div style="margin-top: 10px;">
              <label>Texto do template</label>
              <textarea id="tplBody" placeholder="Copie ou escreva o template aqui..."></textarea>
            </div>
            <div class="row" style="margin-top: 12px;">
              <button id="btnCreateTemplate">Salvar template</button>
              <button id="btnRefreshTemplates" class="ghostBtn">Atualizar lista</button>
            </div>
          </div>
          <div>
            <div class="muted" style="margin-bottom:8px;">Templates salvos</div>
            <div id="templatesList" class="templateList"></div>
          </div>
        </div>
      </div>

      <div class="card fadeIn">
        <div style="display:flex; justify-content:space-between; align-items:center; gap:12px; flex-wrap:wrap;">
          <div>
            <h3 style="margin:0;">Contatos & Segmentos</h3>
            <div class="muted" style="margin-top:6px;">Cadastre contatos e monte segmentos para automacoes.</div>
          </div>
          <button id="btnRefreshCrm" class="ghostBtn">Atualizar</button>
        </div>

        <div class="listGrid" style="margin-top:12px;">
          <div class="card">
            <div style="font-weight:700; margin-bottom:8px;">Novo contato</div>
            <div class="grid2">
              <div>
                <label>Nome</label>
                <input id="contactName" placeholder="Cliente X" />
              </div>
              <div>
                <label>Email</label>
                <input id="contactEmail" placeholder="cliente@email.com" />
              </div>
            </div>
            <div class="grid2" style="margin-top:10px;">
              <div>
                <label>Telefone</label>
                <input id="contactPhone" placeholder="+55 11 99999-9999" />
              </div>
              <div>
                <label>Consentimento (ISO 8601)</label>
                <input id="contactConsent" placeholder="2026-01-11T15:00:00+00:00" />
              </div>
            </div>
            <div style="margin-top:10px;">
              <label>Tags (separadas por virgula)</label>
              <input id="contactTags" placeholder="vip, quente, recorrente" />
            </div>
            <div class="row" style="margin-top:10px;">
              <button id="btnCreateContact">Salvar contato</button>
            </div>
          </div>
          <div class="card">
            <div style="font-weight:700; margin-bottom:8px;">Novo segmento</div>
            <div>
              <label>Nome do segmento</label>
              <input id="segmentName" placeholder="Ex: Leads Quentes" />
            </div>
            <div class="row" style="margin-top:10px;">
              <button id="btnCreateSegment">Criar segmento</button>
            </div>
          </div>
        </div>

        <div class="listGrid" style="margin-top:12px;">
          <div class="card">
            <div style="display:flex; justify-content:space-between; align-items:center; gap:10px;">
              <div style="font-weight:700;">Lista de contatos</div>
              <div class="muted" id="contactsCount">0</div>
            </div>
            <div class="row" style="margin-top:8px;">
              <input id="contactsSearch" placeholder="Buscar contato (nome/email/telefone)" />
              <button id="btnExportContacts" class="ghostBtn">Exportar CSV</button>
            </div>
            <table class="miniTable" style="margin-top:8px;">
              <thead>
                <tr>
                  <th>Nome</th>
                  <th>Email</th>
                  <th>Telefone</th>
                  <th>Tags</th>
                  <th></th>
                </tr>
              </thead>
              <tbody id="contactsList"></tbody>
            </table>
          </div>
          <div class="card">
            <div style="display:flex; justify-content:space-between; align-items:center; gap:10px;">
              <div style="font-weight:700;">Segmentos</div>
              <div class="muted" id="segmentsCount">0</div>
            </div>
            <div class="grid2" style="margin-top:8px;">
              <div>
                <label>Segmento</label>
                <select id="segmentSelect"></select>
              </div>
              <div>
                <label>Contato</label>
                <select id="segmentContactSelect"></select>
              </div>
            </div>
            <div class="row" style="margin-top:8px;">
              <button id="btnAddSegmentMember" class="ghostBtn">Adicionar no segmento</button>
            </div>
            <div class="muted" style="margin-top:10px;">Lista de segmentos</div>
            <table class="miniTable" style="margin-top:6px;">
              <thead>
                <tr>
                  <th>Nome</th>
                  <th></th>
                </tr>
              </thead>
              <tbody id="segmentsList"></tbody>
            </table>
            <div class="muted" style="margin-top:8px;">Membros do segmento</div>
            <div id="segmentMembers" class="templateList"></div>
          </div>
        </div>

        <div class="listGrid" style="margin-top:12px;">
          <div class="card">
            <div style="font-weight:700; margin-bottom:8px;">Nova campanha</div>
            <div class="grid2">
              <div>
                <label>Nome</label>
                <input id="campaignName" placeholder="Ex: Black Friday" />
              </div>
              <div>
                <label>Status</label>
                <select id="campaignStatus">
                  <option value="active">Ativa</option>
                  <option value="paused">Pausada</option>
                  <option value="draft">Draft</option>
                </select>
              </div>
            </div>
            <div style="margin-top:10px;">
              <label>Objetivo</label>
              <input id="campaignObjective" placeholder="Ex: Gerar leads qualificados" />
            </div>
            <div class="grid2" style="margin-top:10px;">
              <div>
                <label>Inicio (ISO 8601)</label>
                <input id="campaignStart" placeholder="2026-01-11T00:00:00+00:00" />
              </div>
              <div>
                <label>Fim (ISO 8601)</label>
                <input id="campaignEnd" placeholder="2026-02-11T00:00:00+00:00" />
              </div>
            </div>
            <div class="row" style="margin-top:10px;">
              <button id="btnCreateCampaign">Salvar campanha</button>
            </div>
          </div>
          <div class="card">
            <div style="display:flex; justify-content:space-between; align-items:center; gap:10px;">
              <div style="font-weight:700;">Campanhas</div>
              <div class="muted" id="campaignsCount">0</div>
            </div>
            <div class="row" style="margin-top:8px;">
              <input id="campaignsSearch" placeholder="Buscar campanha" />
            </div>
            <table class="miniTable" style="margin-top:8px;">
              <thead>
                <tr>
                  <th>Nome</th>
                  <th>Status</th>
                  <th></th>
                </tr>
              </thead>
              <tbody id="campaignsList"></tbody>
            </table>
          </div>
        </div>
      </div>

      <div class="card fadeIn">
        <div style="display:flex; justify-content:space-between; align-items:center; gap:12px; flex-wrap:wrap;">
          <div>
            <h3 style="margin:0;">Automacao de Campanhas</h3>
            <div class="muted" style="margin-top:6px;">Disparo em massa por segmento com agendamento.</div>
          </div>
          <button id="btnRunAutomation" class="ghostBtn">Disparar agora</button>
        </div>

        <div class="templateGrid" style="margin-top:12px;">
          <div>
            <label>Segmento (ID)</label>
            <input id="autoSegmentId" placeholder="Ex: 12" />
          </div>
          <div>
            <label>Campanha (opcional)</label>
            <select id="autoCampaignId">
              <option value="">Sem campanha</option>
            </select>
          </div>
        </div>
        <div class="templateGrid" style="margin-top:12px;">
          <div>
            <label>Canal</label>
            <select id="autoChannel">
              <option value="whatsapp">WhatsApp</option>
              <option value="x">X (Twitter)</option>
              <option value="email">Email</option>
            </select>
          </div>
          <div>
            <label>Agendar (ISO 8601)</label>
            <input id="autoScheduleAt" placeholder="2026-01-11T15:00:00+00:00" />
          </div>
        </div>
        <div class="templateGrid" style="margin-top:12px;">
          <div>
            <label>Template (opcional)</label>
            <select id="autoTemplate">
              <option value="">Sem template</option>
            </select>
          </div>
          <div>
            <label>Variáveis (JSON)</label>
            <input id="autoVariables" placeholder='{"produto":"Plano Pro","desconto":"20%"}' />
          </div>
        </div>
        <div style="margin-top:10px;">
          <label>Mensagem</label>
          <textarea id="autoBody" placeholder="Texto da campanha..."></textarea>
        </div>
        <div id="autoStatus" class="muted" style="margin-top:8px;"></div>

        <div class="card" style="margin-top:12px;">
          <div style="display:flex; justify-content:space-between; align-items:center; gap:12px; flex-wrap:wrap;">
            <div style="font-weight:700;">Fila de envios</div>
            <div class="row">
              <button id="btnRefreshQueue" class="ghostBtn">Atualizar fila</button>
              <label class="muted" style="display:flex; align-items:center; gap:6px;">
                <input type="checkbox" id="queueAutoRefresh" /> Auto
              </label>
            </div>
          </div>
          <table class="miniTable" style="margin-top:8px;">
            <thead>
              <tr>
                <th>ID</th>
                <th>Canal</th>
                <th>Destino</th>
                <th>Status</th>
                <th>Tentativas</th>
                <th>Próxima</th>
              </tr>
            </thead>
            <tbody id="queueList"></tbody>
          </table>
        </div>
      </div>

      <div class="card fadeIn">
        <div class="statusRow">
          <div>
            <h3 style="margin:0;">Meus Anúncios</h3>
            <div id="adsCount" class="muted" style="margin-top:6px;">0 anúncios carregados</div>
          </div>
          <div id="adsStatusSummary" class="statusSummary"></div>
        </div>

        <div class="card" style="margin-top:14px;">
          <div class="filtersRow">
            <div>
              <label>Pesquisar</label>
              <input id="adsSearch" placeholder="Título, texto, palavras-chave..." />
            </div>
            <div>
              <label>Status</label>
              <select id="adsStatus">
                <option value="">Todos</option>
                <option value="draft">Draft</option>
                <option value="scheduled">Agendado</option>
                <option value="sent">Enviado</option>
                <option value="paused">Pausado</option>
              </select>
            </div>
            <div>
              <label>Canal</label>
              <select id="adsChannel">
                <option value="">Todos</option>
                <option value="whatsapp">WhatsApp</option>
                <option value="x">X (Twitter)</option>
                <option value="email">Email</option>
              </select>
            </div>
            <div>
              <label>&nbsp;</label>
              <button id="adsClear" class="ghostBtn">Limpar filtros</button>
            </div>
          </div>
          <div class="filtersRow" style="margin-top:10px;">
            <div>
              <label>Campanha</label>
              <select id="adsCampaign">
                <option value="">Todas</option>
              </select>
            </div>
            <div></div>
            <div></div>
            <div></div>
          </div>
        </div>

        <div id="adsList" class="stagger"></div>
        <div id="adsEmpty" class="muted" style="margin-top:8px;"></div>
        <div class="row" style="margin-top: 10px;">
          <button id="adsLoadMore" class="hidden">Carregar mais</button>
        </div>
      </div>
    </section>

    <script src="./env.js"></script>
    <script type="module" src="./dist/app.js"></script>
  </body>
</html>
